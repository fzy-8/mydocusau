---
title: åˆè¯†DOM
author: å¢¨é±¼ä¸¸å­
author_title: ä¸‰å¤©æ‘¸é±¼ä¸¤å¤©æµ‘æ°´
author_url: https://github.com/JoelMarcey
author_image_url: ../static/img/myFav/1.JPG
tags: [DOM, åˆè¯†]
description: è¿™æ˜¯DOMæœ‰æ„Ÿç¬¬ä¸€ç¯‡ã€‚
image: https://i.imgur.com/mErPwqL.png
hide_table_of_contents: false
---

DOMğŸŒ²ç›¸å…³å¸¸è¯†

<!--truncate-->



# DOM

> å‚è€ƒï¼š
> 
> çº¢å®ä¹¦ç¬¬14ç« ã€ç¬¬15ç« ã€ç¬¬16ç« å’Œå…¨èƒ½çš„MDNé€‰æ‰‹

## DOMä¸­é‡è¦æ•°æ®ç±»å‹
- document æ ¹æ–‡æ¡£
- element       å…ƒç´ æˆ–èŠ‚ç‚¹
- nodeList
- attribute
- namedNodeMap

## DOMä¸­å¸¸ç”¨æ¥å£API

- document.getElementById(id)
- document.getElementsByTagName(name)
- document.createElement(name)
- parentNode.appendChild(node)
- element.innerHTML
- element.style.left
- element.setAttribute()
- element.getAttribute()
- element.addEventListener()
- window.content ğŸ¦Š
- window.onload
- window.dump() ğŸ¦Š
- window.scrollTo()

# DOMæ•°æ®ç±»å‹è¯¦è§£

## 1 Nodeç±»å‹

- node
  - nodeName
  - nodeValue
  - nodeType
  - childNodes

ğŸ’¡ `.nodeType`å±æ€§æŸ¥è¯¢èŠ‚ç‚¹çš„ç±»å‹ï¼ˆ12ç§ï¼‰ã€‚æœ€å¸¸è§ï¼š  
1 -- å…ƒç´ èŠ‚ç‚¹  
3 -- æ–‡æœ¬èŠ‚ç‚¹

### childNodes å±æ€§
æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªchildNodeså±æ€§ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªNodeListçš„å®ä¾‹ã€‚NodeListæ˜¯ä¸€ä¸ªç±»æ•°ç»„å¯¹è±¡ï¼Œä½†å¹¶ä¸æ˜¯Arrayçš„å®ä¾‹ã€‚

ğŸ’¡ childNodeså¯ä»¥ç”¨`[]`è®¿é—®æˆ–è€…`.item()`è®¿é—®ï¼Œä¹Ÿå…·æœ‰lengthå±æ€§ã€‚

#### Array.from() æ–¹æ³• ç±»æ•°ç»„è½¬æ¢æˆæ•°ç»„
```javascript
//ä½¿ç”¨Array.from(someNode.childNodes)å¯ä»¥å°†åŸå‹ä¸ºNodeListè½¬ä¸ºArrayã€‚
> Array.from(document.body.childNodes)

< 
0: div#app
1: script
2: div#juejin-global-search
3: comment
4: text
5: comment
6: text
7: comment
8: text
9: comment
10: text
11: div.mask
12: text
length: 13
[[Prototype]]: Array(0)
//æ³¨æ„æœ€åä¸€è¡Œçš„åŸå‹å·²ç»å˜æˆäº†Array,ä¹‹å‰è¿è¡ŒsomeNode.childNodesåŸå‹è¿˜æ˜¯NodeList.
```
#### hasChildNodes()æ–¹æ³•
è¿”å›å¸ƒå°”å€¼ï¼ŒæŸ¥è¯¢æ˜¯å¦å«æœ‰æ­¤å­èŠ‚ç‚¹ã€‚

### èŠ‚ç‚¹å…³ç³»å±æ€§
```javascript
someNode.firstChild             //ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹
someNode.lastChild              //æœ€åä¸€ä¸ªå­èŠ‚ç‚¹
someNode.parentNode             //çˆ¶èŠ‚ç‚¹
someNode.nextSibling            //ä¸‹ä¸€ä¸ªå…„å¼ŸèŠ‚ç‚¹
someNode.previousSibling        //ä¸Šä¸€ä¸ªå…„å¼ŸèŠ‚ç‚¹
```

### æ“çºµèŠ‚ç‚¹ å››å…„å¼Ÿ ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘§

ğŸ’¡ ä½¿ç”¨å››å…¬å¼ä¹‹å‰ï¼Œéƒ½éœ€è¦å…ˆå»çš„parentNodeèŠ‚ç‚¹ã€‚

#### appendChild() æ–¹æ³•

åœ¨childNodesæœ«å°¾æ·»åŠ èŠ‚ç‚¹ï¼›å¦‚æœä¼ å…¥èŠ‚ç‚¹ä¹‹å‰å°±å­˜åœ¨ï¼Œåˆ™æ”¹å˜å…¶ä½ç½®åˆ°æœ€åã€‚

#### insertBefore() æ–¹æ³•

åœ¨æŒ‡å®šä½ç½®æ’å…¥èŠ‚ç‚¹ï¼Œè€Œéæœ€åã€‚`insertBefore(è¦æ’å…¥èŠ‚ç‚¹ï¼Œå‚è€ƒèŠ‚ç‚¹)`å½“ç¬¬äºŒä¸ªå‚æ•°ä¸ä¼ å…¥ï¼ˆnullï¼‰ï¼Œåˆ™æ’å…¥åˆ°æœ€åã€‚

#### replaceChild() æ–¹æ³•

ä»¥ä¸Šä¸¤ç§æ–¹æ³•éƒ½ä¸åˆ é™¤èŠ‚ç‚¹ï¼Œè€Œç¬¬ä¸‰ç§æ–¹æ³•ä¼šåˆ é™¤åŸæœ‰èŠ‚ç‚¹ã€‚

#### removeChild() æ–¹æ³•

åˆ é™¤èŠ‚ç‚¹ã€‚

---

#### é™„ï¼šæ–¹æ³•

##### cloneNode()

å¤åˆ¶èŠ‚ç‚¹ã€‚å‚æ•°æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œtrueè¡¨ç¤ºâ€œæ·±å¤åˆ¶â€ã€‚

##### normalize() æ–¹æ³•

ç”¨äºè§„èŒƒåŒ–æ–‡æœ¬èŠ‚ç‚¹ã€‚1.åˆ é™¤ç©ºç™½çš„æ–‡æœ¬èŠ‚ç‚¹ï¼›2.åˆå¹¶åŒä¸€çˆ¶èŠ‚ç‚¹ä¸‹çš„å¤šä¸ªå¹¶åˆ—çš„æ–‡æœ¬èŠ‚ç‚¹ã€‚

## 2 Document ç±»å‹

æ–‡æ¡£ç±»å‹çš„èŠ‚ç‚¹æ˜¯**åªè¯»**çš„ï¼ˆä¸å¯ç”¨ä»¥ä¸Šæåˆ°çš„æ“çºµèŠ‚ç‚¹æ–¹æ³•ï¼š`appendChild()`ã€`removeChild()`ã€`replaceChild()`ï¼‰ï¼Œè€Œä¸”åªèƒ½æœ‰**ä¸€ä¸ªElement**ç±»å‹çš„å­èŠ‚ç‚¹ã€‚

**é¡µé¢æ–‡æ¡£çš„æ¶æ„ï¼š**
- document
  - html
    - head
    - body
```
1. .documentElement: <HTML>å…ƒç´ èŠ‚ç‚¹çš„å¿«æ·æ–¹å¼
2. .body : <body>å…ƒç´ èŠ‚ç‚¹çš„å¿«æ·æ–¹å¼
```
### ğŸŒ¶ï¸ è·å–æ–‡æ¡£èŠ‚ç‚¹æ–¹æ³• ğŸŒ¶ï¸

ä»¥ä¸‹æ–¹æ³•çš„å‚æ•° å¤§å°å†™æ•æ„Ÿï¼Œä¸”åªè¿”å›ç¬¬ä¸€ä¸ªç¬¦åˆçš„å…ƒç´ ã€‚

1. `getElementById(â€œå…ƒç´ çš„IDâ€)`
2. `getElementByTagName()` ï¼ˆä¸ªäººå¸¸ç”¨è¿™ä¸ªï¼‰
3. `getElementByName()` -- ä½¿ç”¨Name
4. `getElementByClassName()` -- ä½¿ç”¨ç±»å

è¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯`querySelector()`å’Œ`querySelectorAll()`he
### æ–‡æ¡£ä¿¡æ¯

```javascript
document.title
document.url
document.domain  //å…¶ä¸­åªæœ‰domainæ˜¯å¯è®¾ç½®çš„ï¼Œä½†ä¹Ÿæœ‰è¯¸å¤šé™åˆ¶ã€‚
document.referrer
```

### ç‰¹æ®Šé›†åˆ
```javascript
document.anchors        //è¿”å›æ‰€æœ‰å¸¦nameå±æ€§çš„<a>å…ƒç´ 
document.forms
document.images
document.links          //è¿”å›æ‰€æœ‰å¸¦hrefå±æ€§çš„<a>å…ƒç´ 
```

### åˆ›å»ºèŠ‚ç‚¹
```js
document.createElement("å…ƒç´ çš„æ ‡ç­¾å")
document.createTextNode("è¦æ’å…¥çš„æ–‡æœ¬")   //åˆ›å»ºæ–‡æœ¬èŠ‚ç‚¹
document.createComment("æ³¨é‡Šæ–‡æœ¬")
```

## 3 Element ç±»å‹

ä»¥ä¸‹å±æ€§å‡å¯è®¾ç½®ã€‚

- element
  - nodeName / tagName ğŸŒ¶ï¸
  - id
  - title
  - lang
  - dir
  - className

### è·å–å±æ€§ ğŸŒ¶ï¸

#### æ–¹æ³•ä¸€ï¼š3ç§æ–¹æ³•ï¼ˆæ›´å¸¸ç”¨ï¼‰

1. `getAttribute("å±æ€§å")`
2. `setAttribute("å±æ€§å","å±æ€§å€¼")`
3. `removeAttribute("å±æ€§å")`

å‚æ•°è¦æ±‚å’Œç¤ºèŒƒï¼š

```javascript
let div = document.getElementById("myDiv")

div.getAttribute("class");

div.replaceAttribute("class");

div.setAttribute("class","some");
```

#### æ–¹æ³•äºŒï¼šattributeså±æ€§

åªæœ‰elementç±»å‹æ‹¥æœ‰attributeså±æ€§ï¼Œä»–è¿”å›ä¸€ä¸ªNamedNodeMapå®ä¾‹ï¼Œæ˜¯ä¸€ä¸ªç±»ä¼¼NodeListçš„â€œå®æ—¶â€é›†åˆã€‚

```js
getNamedItem("å±æ€§å")      //è·å–å±æ€§èŠ‚ç‚¹
removeNamedItem("å±æ€§å")   //åˆ é™¤
setNamedItem("å±æ€§å","å±æ€§å€¼")   //è®¾ç½®å±æ€§èŠ‚ç‚¹

let id = element.attributes.getNamedItem("id").nodeValue
//ç­‰ä»·äº
let id = element.attributes["id"].nodeValue
//attributes[] è¿™ç§æ–¹æ³•ä¼šæ›´ç®€ä¾¿ ğŸŒ¶ï¸
```

## 4 Text ç±»å‹

- text
  - nodeValue / data
    - length

ä¿®æ”¹æ–‡æœ¬å†…å®¹çš„æ–¹æ³•ï¼š
```javascript
appendDataï¼ˆtextï¼‰                     //åœ¨æœ«å°¾æ·»åŠ text
insertData(offsetæ’å…¥çš„èµ·å§‹ä½ç½®ï¼Œtext)   //æ’å…¥
replaceData(offset,count,text)        //æ›¿æ¢
deletData(offsetåˆ é™¤èµ·å§‹ä½ç½®ï¼Œcountåˆ é™¤å­—ç¬¦æ•°)   //åˆ é™¤

document.createTextNode()   //åˆ›å»ºæ–‡æœ¬èŠ‚ç‚¹
element.normalize();        //è§„èŒƒåŒ–æ–‡æœ¬èŠ‚ç‚¹
splitText(offset)           //æ‹†åˆ†æ–‡æœ¬èŠ‚ç‚¹ï¼Œä¸normalize()ç›¸åçš„æ–¹æ³•
substringData(offset,count)  //æå–æ–‡æœ¬ä¿¡æ¯
```

## é—®é¢˜
ğŸ«å¦‚ä½•ç¡®å®šèŠ‚ç‚¹æ˜¯å…ƒç´ èŠ‚ç‚¹ï¼Ÿ

```javascript
// å…ˆæ£€æŸ¥èŠ‚ç‚¹ç±»å‹ï¼ï¼ï¼
if (someNode.nodeType == Node.ELEMENT_NODE){
    alert ("Node is an element.");
}
//å…ƒç´ èŠ‚ç‚¹çš„nodeTypeæ˜¯1
```
# DOMåŠ¨æ€ç¼–ç¨‹

htmlå’Œjséƒ½å¯ä»¥å®ç°DOMç¼–ç¨‹ã€‚

## åŠ¨æ€è„šæœ¬

æ–¹æ³•æœ‰ä¸¤ç§ï¼š

**1. å¼•å…¥å¤–éƒ¨æ–‡ä»¶**

```js
//ä¸€ä¸ªè·¨æµè§ˆå™¨çš„å‡½æ•°
function loadScriptString(code){
  var script = document.createElement("script");
  script.type = "text/javascript";
  try {
    script.appendChild(document.createTextNode(code));  //æ–¹æ¡ˆä¸€ï¼šå…ˆå°è¯•appendæ–¹æ³•
  }catch (ex){
    script.text = code;                  //å¦‚æœæŠ¥é”™ï¼Œå°±ä½¿ç”¨æ–¹æ¡ˆäºŒï¼šscriptçš„textå±æ€§
  }
  document.body.appendChild(script);    //æœ€åä¸€å®šè¦æ·»åŠ â€œscript"å…ƒç´ åˆ°bodyæœ«å°¾
  }
}

//è°ƒç”¨å‡½æ•°
loadScriptString("function sayHi(){alert('hi');}");
```

**2. ç›´æ¥æ’å…¥æºç **

```js
function loadStyleString(css){
  let style = document.createElement("style");
  style.type = "text/css";
  try{
    style.appendChild(document.createTextNode(css));
  }catch(ex){
    style.styleSheet.cssText = css;
  }
  let head = document.getElementsByTagName("head")[0];
  head.appendChild(style);
  }
}

//è°ƒç”¨å‡½æ•°
loadStyleString("body{background-color:red}");
```
## åŠ¨æ€æ ·å¼

```
ä¸¤ç§æ–¹å¼ï¼š

1. <link>
2. <style>
```
```js
//æ–¹æ³•ä¸€ï¼š<link>
//æ·»åŠ <link rel="stylesheet" type="text/css" href="styles.css">åˆ°<head>ä¸­
function loadStyles(url){
      let link = document.createElement("link");    //åˆ›å»ºlinkèŠ‚ç‚¹
      link.rel = "stylesheet";
      link.type = "text/css";
      link.href = url;
      let head = document.getElementsByTagName("head")[0];    //æ·»åŠ linkèŠ‚ç‚¹åˆ°<head>ä¸­
      head.appendChild(link);
}
//è°ƒç”¨å‡½æ•°
loadStyles("styles.css");

//æ–¹æ³•äºŒï¼š<style>
function loadStyleString(css){
  let style = document.createElement("style");    //åˆ›å»º<style>èŠ‚ç‚¹
  style.type = "text/css";
  try{
    style.appendChild(document.createTextNode(css));    //ç”¨DOMå¢åŠ èŠ‚ç‚¹
  } catch (ex){
    style.styleSheet.cssText = css;   //è®¿é—®å±æ€§style.styleSheet.cssText
  }
  let head = document.getElementsByTagName("head")[0];
    head.appendChild(style);    //æ·»åŠ styleèŠ‚ç‚¹åˆ°<head>ä¸­
}
//è°ƒç”¨å‡½æ•°
loadStyleString("body{background-color:red}");
```
